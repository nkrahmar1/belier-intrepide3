<!DOCTYPE html>
<html>
<head>
    <title>Cr√©er des donn√©es de test</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h1>üõ†Ô∏è Cr√©er des donn√©es de test</h1>
        
        <?php
        if ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_POST['create_data'])) {
            require '../vendor/autoload.php';
            
            $app = require '../bootstrap/app.php';
            $app->make(Illuminate\Contracts\Console\Kernel::class)->bootstrap();
            
            try {
                // Cr√©er des cat√©gories
                $categories = [
                    ['nom' => 'Politique', 'slug' => 'politique', 'description' => 'Articles sur la politique'],
                    ['nom' => '√âconomie', 'slug' => 'economie', 'description' => 'Articles sur l\'√©conomie'],
                    ['nom' => 'Sport', 'slug' => 'sport', 'description' => 'Articles sur le sport'],
                    ['nom' => 'Technologie', 'slug' => 'technologie', 'description' => 'Articles sur la technologie'],
                ];
                
                foreach ($categories as $catData) {
                    \App\Models\Category::firstOrCreate(
                        ['slug' => $catData['slug']],
                        $catData
                    );
                }
                
                // Cr√©er un utilisateur admin si n√©cessaire
                $admin = \App\Models\User::firstOrCreate(
                    ['email' => 'admin@test.com'],
                    [
                        'name' => 'Admin Test',
                        'password' => bcrypt('password'),
                        'is_admin' => true,
                        'email_verified_at' => now(),
                    ]
                );
                
                // Cr√©er des articles de test
                $articleTitles = [
                    '√âconomie' => [
                        'Analyse de la croissance √©conomique 2024',
                        'Les d√©fis de l\'inflation mondiale',
                        'Investissements et nouvelles opportunit√©s'
                    ],
                    'Politique' => [
                        'Les enjeux des prochaines √©lections',
                        'R√©formes gouvernementales en cours',
                        'Politique internationale et relations diplomatiques'
                    ],
                    'Sport' => [
                        'R√©sultats des championnats nationaux',
                        'Pr√©paration pour les comp√©titions internationales',
                        'Nouveaux talents √©mergents'
                    ],
                    'Technologie' => [
                        'Innovations en intelligence artificielle',
                        'Tendances du d√©veloppement web',
                        'Cybers√©curit√© et protection des donn√©es'
                    ]
                ];
                
                foreach ($articleTitles as $categoryName => $titles) {
                    $category = \App\Models\Category::where('nom', $categoryName)->first();
                    
                    foreach ($titles as $title) {
                        \App\Models\Article::firstOrCreate(
                            ['titre' => $title],
                            [
                                'contenu' => "Ceci est le contenu d√©taill√© de l'article intitul√© '{$title}'. Il contient des informations pertinentes et d√©taill√©es sur le sujet trait√©. L'article a √©t√© cr√©√© √† des fins de test et d√©montre la fonctionnalit√© du syst√®me de gestion d'articles.",
                                'category_id' => $category->id,
                                'user_id' => $admin->id,
                                'is_published' => true,
                                'created_at' => now()->subDays(rand(1, 30)),
                                'updated_at' => now(),
                            ]
                        );
                    }
                }
                
                $totalArticles = \App\Models\Article::count();
                $totalCategories = \App\Models\Category::count();
                
                echo "<div class='alert alert-success'>";
                echo "<h4>‚úÖ Donn√©es cr√©√©es avec succ√®s !</h4>";
                echo "<p>Cat√©gories cr√©√©es : {$totalCategories}</p>";
                echo "<p>Articles cr√©√©s : {$totalArticles}</p>";
                echo "</div>";
                
            } catch (Exception $e) {
                echo "<div class='alert alert-danger'>‚ùå Erreur : " . htmlspecialchars($e->getMessage()) . "</div>";
            }
        }
        ?>
        
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Cr√©er des donn√©es de test</h5>
                <p class="card-text">Cliquez sur le bouton ci-dessous pour cr√©er automatiquement des cat√©gories et des articles de test.</p>
                
                <form method="POST">
                    <button type="submit" name="create_data" value="1" class="btn btn-primary">
                        üöÄ Cr√©er les donn√©es de test
                    </button>
                </form>
            </div>
        </div>
        
        <div class="mt-4">
            <a href="/articles" class="btn btn-success">Voir les articles</a>
            <a href="/admin/dashboard" class="btn btn-info">Dashboard Admin</a>
            <a href="/test-articles-direct.html" class="btn btn-secondary">Test direct</a>
        </div>
    </div>
</body>
</html>
