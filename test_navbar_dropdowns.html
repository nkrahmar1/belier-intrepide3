<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Navbar Dropdowns</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h1 class="mb-4">üß™ Test des Dropdowns de la Navbar</h1>
        
        <!-- √âtat de Bootstrap -->
        <div class="card mb-4">
            <div class="card-header">
                <h5>üìä √âtat du syst√®me</h5>
            </div>
            <div class="card-body">
                <div id="bootstrap-status" class="alert alert-info">V√©rification de Bootstrap...</div>
                <div id="jquery-status" class="alert alert-info">V√©rification de jQuery...</div>
            </div>
        </div>

        <!-- Test des dropdowns -->
        <div class="card mb-4">
            <div class="card-header">
                <h5>üîΩ Test des Dropdowns</h5>
            </div>
            <div class="card-body">
                
                <!-- Dropdown Mon Compte -->
                <div class="btn-group me-3 mb-3">
                    <button type="button" class="btn btn-primary dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                        Mon compte
                    </button>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="#" onclick="testClick('Se connecter')">Se Connecter</a></li>
                        <li><a class="dropdown-item" href="#" onclick="testClick('S inscrire')">S'inscrire</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li>
                            <form style="margin: 0;">
                                <button type="button" class="dropdown-item d-flex align-items-center gap-2" onclick="testClick('Se d√©connecter')">
                                    <i class="bi bi-box-arrow-right"></i> Se d√©connecter
                                </button>
                            </form>
                        </li>
                    </ul>
                </div>

                <!-- Dropdown Panier -->
                <div class="dropdown mb-3">
                    <a href="#" class="btn btn-success dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false" id="cartDropdown">
                        <i class="bi bi-cart3"></i> Panier
                        <span class="badge bg-danger ms-1">3</span>
                    </a>
                    <ul class="dropdown-menu" style="min-width: 300px;">
                        <li class="px-3 py-2">
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <div class="fw-bold">
                                        <i class="bi bi-download text-success me-1"></i>
                                        Article test
                                    </div>
                                    <small class="text-muted">T√©l√©charg√© 1 fois</small>
                                </div>
                                <button class="btn btn-sm btn-outline-danger">
                                    <i class="bi bi-trash"></i>
                                </button>
                            </div>
                        </li>
                        <li><hr class="dropdown-divider"></li>
                        <li class="px-3 py-2">
                            <div class="d-flex justify-content-between">
                                <span><i class="bi bi-download text-success"></i> T√©l√©chargements:</span>
                                <span class="badge bg-success">1</span>
                            </div>
                            <div class="mt-2">
                                <button class="btn btn-primary btn-sm w-100" onclick="testClick('Voir panier complet')">
                                    <i class="bi bi-eye"></i> Voir le panier complet
                                </button>
                            </div>
                        </li>
                    </ul>
                </div>

            </div>
        </div>

        <!-- Console de test -->
        <div class="card">
            <div class="card-header">
                <h5>üìù Console de test</h5>
            </div>
            <div class="card-body">
                <div id="test-console" class="bg-dark text-white p-3 rounded" style="height: 200px; overflow-y: auto; font-family: monospace; font-size: 12px;">
                    <div class="text-success">[INFO] Console de test initialis√©e</div>
                </div>
                <button class="btn btn-secondary btn-sm mt-2" onclick="clearConsole()">Effacer la console</button>
            </div>
        </div>

        <!-- Boutons de test -->
        <div class="card mt-4">
            <div class="card-header">
                <h5>üéÆ Actions de test</h5>
            </div>
            <div class="card-body">
                <button class="btn btn-info me-2" onclick="testDropdowns()">Tester les dropdowns</button>
                <button class="btn btn-warning me-2" onclick="checkBootstrap()">V√©rifier Bootstrap</button>
                <button class="btn btn-danger me-2" onclick="simulateError()">Simuler erreur</button>
                <a href="http://127.0.0.1:8003" class="btn btn-success">Retour au site</a>
            </div>
        </div>
    </div>

    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        const console_div = document.getElementById('test-console');
        
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const colors = {
                info: 'text-info',
                success: 'text-success', 
                warning: 'text-warning',
                error: 'text-danger'
            };
            
            console_div.innerHTML += `<div class="${colors[type]}">[${timestamp}] ${message}</div>`;
            console_div.scrollTop = console_div.scrollHeight;
        }

        function clearConsole() {
            console_div.innerHTML = '<div class="text-success">[INFO] Console effac√©e</div>';
        }

        function testClick(action) {
            log(`Action cliqu√©e: ${action}`, 'success');
        }

        function testDropdowns() {
            log('üß™ Test des dropdowns...', 'info');
            
            const dropdowns = document.querySelectorAll('[data-bs-toggle="dropdown"]');
            log(`Dropdowns trouv√©s: ${dropdowns.length}`, 'info');
            
            dropdowns.forEach((dropdown, index) => {
                try {
                    const instance = bootstrap.Dropdown.getInstance(dropdown) || new bootstrap.Dropdown(dropdown);
                    log(`‚úÖ Dropdown ${index + 1} OK`, 'success');
                } catch (error) {
                    log(`‚ùå Dropdown ${index + 1} ERROR: ${error.message}`, 'error');
                }
            });
        }

        function checkBootstrap() {
            log('üîç V√©rification de Bootstrap...', 'info');
            
            if (typeof bootstrap !== 'undefined') {
                log('‚úÖ Bootstrap charg√©', 'success');
                log(`Version: ${bootstrap.Tooltip.VERSION || 'inconnue'}`, 'info');
            } else {
                log('‚ùå Bootstrap NON charg√©', 'error');
            }
        }

        function simulateError() {
            log('üî• Simulation d\'erreur...', 'warning');
            try {
                throw new Error('Erreur simul√©e pour test');
            } catch (error) {
                log(`‚ùå ${error.message}`, 'error');
            }
        }

        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            log('üöÄ DOM charg√©', 'success');
            
            // V√©rifier Bootstrap
            const bootstrapStatus = document.getElementById('bootstrap-status');
            const jqueryStatus = document.getElementById('jquery-status');
            
            if (typeof bootstrap !== 'undefined') {
                bootstrapStatus.className = 'alert alert-success';
                bootstrapStatus.innerHTML = '‚úÖ Bootstrap est charg√© et disponible';
                log('‚úÖ Bootstrap disponible', 'success');
            } else {
                bootstrapStatus.className = 'alert alert-danger';
                bootstrapStatus.innerHTML = '‚ùå Bootstrap n\'est pas charg√©';
                log('‚ùå Bootstrap indisponible', 'error');
            }

            if (typeof $ !== 'undefined') {
                jqueryStatus.className = 'alert alert-success';
                jqueryStatus.innerHTML = '‚úÖ jQuery est charg√© (optionnel)';
            } else {
                jqueryStatus.className = 'alert alert-warning';
                jqueryStatus.innerHTML = '‚ö†Ô∏è jQuery n\'est pas charg√© (normal avec Bootstrap 5)';
            }

            // Initialiser les dropdowns
            testDropdowns();

            // √âcouter les √©v√©nements de dropdown
            document.addEventListener('show.bs.dropdown', function(e) {
                log(`üîΩ Dropdown ouvert: ${e.target.textContent.trim()}`, 'success');
            });

            document.addEventListener('hide.bs.dropdown', function(e) {
                log(`üîº Dropdown ferm√©: ${e.target.textContent.trim()}`, 'info');
            });

            log('‚úÖ Test page initialis√©e', 'success');
        });
    </script>
</body>
</html>
